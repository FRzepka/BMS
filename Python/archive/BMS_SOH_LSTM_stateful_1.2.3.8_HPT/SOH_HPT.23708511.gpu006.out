Error while loading conda entry point: conda-libmamba-solver (libarchive.so.20: cannot open shared object file: No such file or directory)
Error while loading conda entry point: conda-libmamba-solver (libarchive.so.20: cannot open shared object file: No such file or directory)
[I 2025-05-19 12:25:19,296] A new study created in memory with name: no-name-b68c2f41-d41a-43b5-b8b6-d27dced15d33
/home/users/f/flo01010010/HPC_projects/Scripts/BMS/Python/BMS_SOH_LSTM_stateful_1.2.3.8_HPT/BMS_SOH_LSTM_stateful_1.2.3.8_HPT.py:411: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform("lr", 1e-5, 1e-2)
/home/users/f/flo01010010/HPC_projects/Scripts/BMS/Python/BMS_SOH_LSTM_stateful_1.2.3.8_HPT/BMS_SOH_LSTM_stateful_1.2.3.8_HPT.py:413: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float instead.
  dropout = trial.suggest_uniform("dropout", 0.1, 0.5)
Using device: cpu
[INFO] Skaler über alle Zellen fitten
[DEBUG] MGFarm_18650_C01 NaNs after train scaling: none
[DEBUG] MGFarm_18650_C03 NaNs after train scaling: none
[DEBUG] MGFarm_18650_C05 NaNs after train scaling: none
[DEBUG] MGFarm_18650_C09 NaNs after train scaling: none
[DEBUG] MGFarm_18650_C11 NaNs after train scaling: none
[DEBUG] MGFarm_18650_C13 NaNs after train scaling: none
[DEBUG] MGFarm_18650_C15 NaNs after train scaling: none
[DEBUG] MGFarm_18650_C17 NaNs after train scaling: none
[DEBUG] MGFarm_18650_C19 NaNs after train scaling: none
[DEBUG] MGFarm_18650_C21 NaNs after train scaling: none
[DEBUG] MGFarm_18650_C23 NaNs after train scaling: none
[DEBUG] MGFarm_18650_C25 NaNs after train scaling: none
[DEBUG] MGFarm_18650_C27 NaNs after train scaling: none
[DEBUG] df_val length: 7247194, df_test length: 1449438
[DEBUG] df_val NaNs: {'Voltage[V]': 0, 'Current[A]': 0, 'Q_m': 0}
[DEBUG] df_test NaNs: {'Voltage[V]': 0, 'Current[A]': 0, 'Q_m': 0}
[INFO] Global data loaded and scaled once for HPT.
[INFO] Train cells=['MGFarm_18650_C01', 'MGFarm_18650_C03', 'MGFarm_18650_C05', 'MGFarm_18650_C09', 'MGFarm_18650_C11', 'MGFarm_18650_C13', 'MGFarm_18650_C15', 'MGFarm_18650_C17', 'MGFarm_18650_C19', 'MGFarm_18650_C21', 'MGFarm_18650_C23', 'MGFarm_18650_C25', 'MGFarm_18650_C27'], Val/Test cell=MGFarm_18650_C07

--- Epoch 1/30 ---
[Epoch 1] Training Cell MGFarm_18650_C01
[Epoch 1] Training Cell MGFarm_18650_C03
[Epoch 1] Training Cell MGFarm_18650_C05
[Epoch 1] Training Cell MGFarm_18650_C09
[Epoch 1] Training Cell MGFarm_18650_C11
[Epoch 1] Training Cell MGFarm_18650_C13
[Epoch 1] Training Cell MGFarm_18650_C15
[Epoch 1] Training Cell MGFarm_18650_C17
[Epoch 1] Training Cell MGFarm_18650_C19
[Epoch 1] Training Cell MGFarm_18650_C21
[Epoch 1] Training Cell MGFarm_18650_C23
[Epoch 1] Training Cell MGFarm_18650_C25
[Epoch 1] Training Cell MGFarm_18650_C27
[Epoch 1] train RMSE=0.0894
[Epoch 1] val RMSE=0.0276
[Epoch 1] Modell gespeichert: trial_00_hs64_dr0.2040_lr1e-05/best_model.pth

--- Epoch 2/30 ---
[Epoch 2] Training Cell MGFarm_18650_C01
[Epoch 2] Training Cell MGFarm_18650_C03
[Epoch 2] Training Cell MGFarm_18650_C05
[Epoch 2] Training Cell MGFarm_18650_C09
[Epoch 2] Training Cell MGFarm_18650_C11
[Epoch 2] Training Cell MGFarm_18650_C13
[Epoch 2] Training Cell MGFarm_18650_C15
[Epoch 2] Training Cell MGFarm_18650_C17
[Epoch 2] Training Cell MGFarm_18650_C19
[Epoch 2] Training Cell MGFarm_18650_C21
[Epoch 2] Training Cell MGFarm_18650_C23
[Epoch 2] Training Cell MGFarm_18650_C25
[Epoch 2] Training Cell MGFarm_18650_C27
[Epoch 2] train RMSE=0.0382
[Epoch 2] val RMSE=0.0298

--- Epoch 3/30 ---
[Epoch 3] Training Cell MGFarm_18650_C01
[Epoch 3] Training Cell MGFarm_18650_C03
[Epoch 3] Training Cell MGFarm_18650_C05
[Epoch 3] Training Cell MGFarm_18650_C09
[Epoch 3] Training Cell MGFarm_18650_C11
[Epoch 3] Training Cell MGFarm_18650_C13
[Epoch 3] Training Cell MGFarm_18650_C15
[Epoch 3] Training Cell MGFarm_18650_C17
[Epoch 3] Training Cell MGFarm_18650_C19
[Epoch 3] Training Cell MGFarm_18650_C21
[Epoch 3] Training Cell MGFarm_18650_C23
[Epoch 3] Training Cell MGFarm_18650_C25
[Epoch 3] Training Cell MGFarm_18650_C27
[Epoch 3] train RMSE=0.0362
[Epoch 3] val RMSE=0.0317

--- Epoch 4/30 ---
[Epoch 4] Training Cell MGFarm_18650_C01
[Epoch 4] Training Cell MGFarm_18650_C03
[Epoch 4] Training Cell MGFarm_18650_C05
[Epoch 4] Training Cell MGFarm_18650_C09
[Epoch 4] Training Cell MGFarm_18650_C11
[Epoch 4] Training Cell MGFarm_18650_C13
[Epoch 4] Training Cell MGFarm_18650_C15
[Epoch 4] Training Cell MGFarm_18650_C17
[Epoch 4] Training Cell MGFarm_18650_C19
[Epoch 4] Training Cell MGFarm_18650_C21
[Epoch 4] Training Cell MGFarm_18650_C23
[Epoch 4] Training Cell MGFarm_18650_C25
[Epoch 4] Training Cell MGFarm_18650_C27
[Epoch 4] train RMSE=0.0354
[Epoch 4] val RMSE=0.0322

--- Epoch 5/30 ---
[Epoch 5] Training Cell MGFarm_18650_C01
[Epoch 5] Training Cell MGFarm_18650_C03
[Epoch 5] Training Cell MGFarm_18650_C05
[Epoch 5] Training Cell MGFarm_18650_C09
[Epoch 5] Training Cell MGFarm_18650_C11
[Epoch 5] Training Cell MGFarm_18650_C13
[Epoch 5] Training Cell MGFarm_18650_C15
[Epoch 5] Training Cell MGFarm_18650_C17
[Epoch 5] Training Cell MGFarm_18650_C19
[Epoch 5] Training Cell MGFarm_18650_C21
[Epoch 5] Training Cell MGFarm_18650_C23
[Epoch 5] Training Cell MGFarm_18650_C25
[Epoch 5] Training Cell MGFarm_18650_C27
[Epoch 5] train RMSE=0.0350
[Epoch 5] val RMSE=0.0329

--- Epoch 6/30 ---
[Epoch 6] Training Cell MGFarm_18650_C01
[Epoch 6] Training Cell MGFarm_18650_C03
[Epoch 6] Training Cell MGFarm_18650_C05
[Epoch 6] Training Cell MGFarm_18650_C09
[Epoch 6] Training Cell MGFarm_18650_C11
[Epoch 6] Training Cell MGFarm_18650_C13
[Epoch 6] Training Cell MGFarm_18650_C15
[Epoch 6] Training Cell MGFarm_18650_C17
[Epoch 6] Training Cell MGFarm_18650_C19
[Epoch 6] Training Cell MGFarm_18650_C21
[Epoch 6] Training Cell MGFarm_18650_C23
[Epoch 6] Training Cell MGFarm_18650_C25
[Epoch 6] Training Cell MGFarm_18650_C27
/home/users/f/flo01010010/HPC_projects/Scripts/BMS/Python/BMS_SOH_LSTM_stateful_1.2.3.8_HPT/BMS_SOH_LSTM_stateful_1.2.3.8_HPT.py:380: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(out_dir / "best_model.pth"))
[I 2025-05-19 15:09:13,366] Trial 0 finished with value: 0.027562450261560276 and parameters: {'lr': 1.2136603116149308e-05, 'hidden_size': 64, 'dropout': 0.20404461386492426}. Best is trial 0 with value: 0.027562450261560276.
/home/users/f/flo01010010/HPC_projects/Scripts/BMS/Python/BMS_SOH_LSTM_stateful_1.2.3.8_HPT/BMS_SOH_LSTM_stateful_1.2.3.8_HPT.py:411: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform("lr", 1e-5, 1e-2)
/home/users/f/flo01010010/HPC_projects/Scripts/BMS/Python/BMS_SOH_LSTM_stateful_1.2.3.8_HPT/BMS_SOH_LSTM_stateful_1.2.3.8_HPT.py:413: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float instead.
  dropout = trial.suggest_uniform("dropout", 0.1, 0.5)
[Epoch 6] train RMSE=0.0380
[Epoch 6] val RMSE=0.0350
[INFO] Frühes Stoppen bei Epoche 6
[INFO] Finale Bewertung -> Val RMSE: 0.0276, Test RMSE: 0.0157
[INFO] Train cells=['MGFarm_18650_C01', 'MGFarm_18650_C03', 'MGFarm_18650_C05', 'MGFarm_18650_C09', 'MGFarm_18650_C11', 'MGFarm_18650_C13', 'MGFarm_18650_C15', 'MGFarm_18650_C17', 'MGFarm_18650_C19', 'MGFarm_18650_C21', 'MGFarm_18650_C23', 'MGFarm_18650_C25', 'MGFarm_18650_C27'], Val/Test cell=MGFarm_18650_C07

--- Epoch 1/30 ---
[Epoch 1] Training Cell MGFarm_18650_C01
[Epoch 1] Training Cell MGFarm_18650_C03
[Epoch 1] Training Cell MGFarm_18650_C05
[Epoch 1] Training Cell MGFarm_18650_C09
[Epoch 1] Training Cell MGFarm_18650_C11
[Epoch 1] Training Cell MGFarm_18650_C13
[Epoch 1] Training Cell MGFarm_18650_C15
[Epoch 1] Training Cell MGFarm_18650_C17
[Epoch 1] Training Cell MGFarm_18650_C19
